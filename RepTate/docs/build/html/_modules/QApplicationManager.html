

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>QApplicationManager &#8212; RepTate 0.9.7 20200117 documentation</title>
    <link rel="stylesheet" href="../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/bizstyle.js"></script>
    <link rel="shortcut icon" href="../_static/Reptate64.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">RepTate 0.9.7 20200117 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/RepTatelogo.jpg" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for QApplicationManager</h1><div class="highlight"><pre>
<span></span><span class="c1"># RepTate: Rheology of Entangled Polymers: Toolkit for the Analysis of Theory and Experiments</span>
<span class="c1"># --------------------------------------------------------------------------------------------------------</span>
<span class="c1">#</span>
<span class="c1"># Authors:</span>
<span class="c1">#     Jorge Ramirez, jorge.ramirez@upm.es</span>
<span class="c1">#     Victor Boudara, victor.boudara@gmail.com</span>
<span class="c1">#</span>
<span class="c1"># Useful links:</span>
<span class="c1">#     http://blogs.upm.es/compsoftmatter/software/reptate/</span>
<span class="c1">#     https://github.com/jorge-ramirez-upm/RepTate</span>
<span class="c1">#     http://reptate.readthedocs.io</span>
<span class="c1">#</span>
<span class="c1"># --------------------------------------------------------------------------------------------------------</span>
<span class="c1">#</span>
<span class="c1"># Copyright (2017-2020): Jorge Ramirez, Victor Boudara, Universidad Polit√©cnica de Madrid, University of Leeds</span>
<span class="c1">#</span>
<span class="c1"># This file is part of RepTate.</span>
<span class="c1">#</span>
<span class="c1"># RepTate is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># RepTate is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with RepTate.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">#</span>
<span class="c1"># --------------------------------------------------------------------------------------------------------</span>
<span class="sd">&quot;&quot;&quot;Module QApplicationManager</span>

<span class="sd">Module for the main Graphical User Interface of RepTate. It is the GUI counterpart of</span>
<span class="sd">ApplicationManager.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#import logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">join</span><span class="p">,</span> <span class="n">abspath</span>
<span class="kn">from</span> <span class="nn">PyQt5.uic</span> <span class="k">import</span> <span class="n">loadUiType</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="k">import</span> <span class="n">QIcon</span><span class="p">,</span> <span class="n">QDesktopServices</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="k">import</span> <span class="n">QUrl</span><span class="p">,</span> <span class="n">Qt</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="k">import</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QInputDialog</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QMenu</span><span class="p">,</span> <span class="n">QAction</span><span class="p">,</span> <span class="n">QToolButton</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QFileDialog</span>

<span class="kn">from</span> <span class="nn">CmdBase</span> <span class="k">import</span> <span class="n">CmdBase</span><span class="p">,</span> <span class="n">CmdMode</span><span class="p">,</span> <span class="n">CalcMode</span>
<span class="kn">from</span> <span class="nn">QApplicationWindow</span> <span class="k">import</span> <span class="n">QApplicationWindow</span>
<span class="kn">from</span> <span class="nn">ApplicationManager</span> <span class="k">import</span> <span class="n">ApplicationManager</span>
<span class="kn">from</span> <span class="nn">File</span> <span class="k">import</span> <span class="n">File</span>
<span class="kn">from</span> <span class="nn">QAboutReptate</span> <span class="k">import</span> <span class="n">AboutWindow</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">Version</span>

<span class="n">PATH</span> <span class="o">=</span> <span class="n">dirname</span><span class="p">(</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">Ui_MainWindow</span><span class="p">,</span> <span class="n">QMainWindow</span> <span class="o">=</span> <span class="n">loadUiType</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">PATH</span><span class="p">,</span> <span class="s1">&#39;ReptateMainWindow.ui&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="QApplicationManager"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager">[docs]</a><span class="k">class</span> <span class="nc">QApplicationManager</span><span class="p">(</span><span class="n">ApplicationManager</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">Ui_MainWindow</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Main Reptate window and application manager</span>
<span class="sd">    </span>
<span class="sd">    [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">help_file</span> <span class="o">=</span> <span class="s1">&#39;http://reptate.readthedocs.io/index.html&#39;</span>
    <span class="c1">#reptatelogger = logging.getLogger(&#39;ReptateLogger&#39;)</span>
    <span class="c1">#reptatelogger.setLevel(logging.DEBUG)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Constructor**</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            - parent {[type]} -- [description] (default: {None})</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">Ui_MainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">CmdBase</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">CmdMode</span><span class="o">.</span><span class="n">GUI</span>  <span class="c1">#set GUI mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">CmdBase</span><span class="o">.</span><span class="n">calcmode</span> <span class="o">==</span> <span class="n">CalcMode</span><span class="o">.</span><span class="n">singlethread</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;RepTate v&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span>
                                <span class="s1">&#39; - SINGLE THREAD!!&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;RepTate v&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>

        <span class="c1"># Add Apps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarApps</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionMWD</span><span class="p">)</span>
        <span class="n">tbut</span> <span class="o">=</span> <span class="n">QToolButton</span><span class="p">()</span>
        <span class="n">tbut</span><span class="o">.</span><span class="n">setPopupMode</span><span class="p">(</span><span class="n">QToolButton</span><span class="o">.</span><span class="n">MenuButtonPopup</span><span class="p">)</span>
        <span class="n">tbut</span><span class="o">.</span><span class="n">setDefaultAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionTTS</span><span class="p">)</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="n">QMenu</span><span class="p">()</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionTTSFactors</span><span class="p">)</span>
        <span class="n">tbut</span><span class="o">.</span><span class="n">setMenu</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarApps</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">tbut</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarApps</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionLVE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarApps</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionNLVE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarApps</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionGt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarApps</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionCreep</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarApps</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionSANS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarApps</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionReact</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarApps</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionDielectric</span><span class="p">)</span>
        <span class="c1"># self.toolBarApps.addAction(self.actionDynamicStructureFactor)</span>
        <span class="c1"># self.toolBarApps.addAction(self.actionLAOS)</span>

        <span class="c1">#help button</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;:/Icon8/Images/new_icons/icons8-user-manual.png&#39;</span><span class="p">)</span>
        <span class="c1">#self.show_reptate_help = QAction(icon, &#39;RepTate Manual&#39;, self)</span>
        <span class="c1">#self.show_app_help = QAction(icon, &#39;Application Manual&#39;, self)</span>
        <span class="c1">#self.show_th_help = QAction(icon, &#39;Theory Manual&#39;, self)</span>
        <span class="n">tbut</span> <span class="o">=</span> <span class="n">QToolButton</span><span class="p">()</span>
        <span class="n">tbut</span><span class="o">.</span><span class="n">setPopupMode</span><span class="p">(</span><span class="n">QToolButton</span><span class="o">.</span><span class="n">MenuButtonPopup</span><span class="p">)</span>
        <span class="n">tbut</span><span class="o">.</span><span class="n">setDefaultAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionShow_reptate_help</span><span class="p">)</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="n">QMenu</span><span class="p">()</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionShow_app_help</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionShow_th_help</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionShow_offline_help</span><span class="p">)</span>
        <span class="n">tbut</span><span class="o">.</span><span class="n">setMenu</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>
        <span class="c1">#self.toolBarHelpAbout.insertWidget(self.actionAbout_Qt, tbut)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarHelpAbout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">tbut</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarHelpAbout</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        
        <span class="n">tbut</span> <span class="o">=</span> <span class="n">QToolButton</span><span class="p">()</span>
        <span class="n">tbut</span><span class="o">.</span><span class="n">setPopupMode</span><span class="p">(</span><span class="n">QToolButton</span><span class="o">.</span><span class="n">MenuButtonPopup</span><span class="p">)</span>
        <span class="n">tbut</span><span class="o">.</span><span class="n">setDefaultAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionAbout</span><span class="p">)</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="n">QMenu</span><span class="p">()</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionAbout_Qt</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionAboutMatplotlib</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionAboutNumpy</span><span class="p">)</span>        
        <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionAboutScipy</span><span class="p">)</span>
        <span class="n">tbut</span><span class="o">.</span><span class="n">setMenu</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarHelpAbout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">tbut</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarHelpAbout</span><span class="o">.</span><span class="n">insertSeparator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionAbout_Qt</span><span class="p">)</span>
        <span class="c1">#self.toolBar.insertSeparator(self.actionQuit)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarProject</span><span class="o">.</span><span class="n">setContextMenuPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">PreventContextMenu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarApps</span><span class="o">.</span><span class="n">setContextMenuPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">PreventContextMenu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBarHelpAbout</span><span class="o">.</span><span class="n">setContextMenuPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">PreventContextMenu</span><span class="p">)</span>
        
        <span class="c1"># # ApplicationXY button</span>
        <span class="c1"># #choose the button icon</span>
        <span class="c1"># icon = QIcon(&#39;:/Icon8/Images/new_icons/XY.png&#39;)</span>
        <span class="c1"># tool_tip = &#39;XY&#39;  # text that appear on hover</span>
        <span class="c1"># self.actionXY = QAction(icon, tool_tip, self)</span>
        <span class="c1"># #insert the new button before the &quot;MWD&quot; button</span>
        <span class="c1"># self.toolBarApps.insertAction(self.actionMWD, self.actionXY)</span>
        <span class="c1"># #connect button</span>
        <span class="c1"># self.actionXY.triggered.connect(lambda: self.handle_new_app(&#39;XY&#39;))</span>

        <span class="c1"># App tabs behaviour</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">setMovable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">setTabsClosable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">setUsesScrollButtons</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># log file</span>
        <span class="c1">#log_file_name = &#39;Qreptate.log&#39;</span>
        <span class="c1">#handler = logging.handlers.RotatingFileHandler(</span>
        <span class="c1">#    log_file_name, maxBytes=20000, backupCount=2)</span>
        <span class="c1">#self.reptatelogger.addHandler(handler)</span>

        <span class="c1"># Connect actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionOpenProject</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">launch_open_dialog</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionSaveProject</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">launch_save_dialog</span><span class="p">)</span>

        <span class="c1"># Generate action buttons from dict of available applications</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionMWD</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_new_app</span><span class="p">(</span><span class="s1">&#39;MWD&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionTTS</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_new_app</span><span class="p">(</span><span class="s1">&#39;TTS&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionTTSFactors</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_new_app</span><span class="p">(</span><span class="s1">&#39;TTSF&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionLVE</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_new_app</span><span class="p">(</span><span class="s1">&#39;LVE&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionNLVE</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_new_app</span><span class="p">(</span><span class="s1">&#39;NLVE&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionGt</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_new_app</span><span class="p">(</span><span class="s1">&#39;Gt&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionCreep</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_new_app</span><span class="p">(</span><span class="s1">&#39;Creep&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionSANS</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_new_app</span><span class="p">(</span><span class="s1">&#39;SANS&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionReact</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_new_app</span><span class="p">(</span><span class="s1">&#39;React&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionDielectric</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_new_app</span><span class="p">(</span><span class="s1">&#39;Dielectric&#39;</span><span class="p">))</span>

        <span class="c1"># self.actionLAOS.triggered.connect(lambda: self.handle_app_coming_soon(&#39;LAOS&#39;))</span>
        <span class="c1"># self.actionDynamicStructureFactor.triggered.connect(lambda: self.handle_app_coming_soon(&#39;DynamicStructureFactor&#39;))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">tabCloseRequested</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close_app_tab</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">currentChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_changed</span><span class="p">)</span>
        <span class="c1">#self.Projecttree.itemSelectionChanged.connect(self.treeChanged)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actionAbout_Qt</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">QApplication</span><span class="o">.</span><span class="n">aboutQt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionAbout</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_about</span><span class="p">)</span>

        <span class="n">connection_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">tabBarDoubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_doubleClickTab</span><span class="p">)</span>
        <span class="c1"># help buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionShow_reptate_help</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_show_reptate_help</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionShow_app_help</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_show_app_help</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionShow_th_help</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_show_th_help</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionShow_offline_help</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_actionShow_offline_help</span><span class="p">)</span>
        
        <span class="c1"># additional about buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionAboutMatplotlib</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_about_matplotlib</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionAboutNumpy</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_about_numpy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionAboutScipy</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_about_scipy</span><span class="p">)</span>


        <span class="c1">#self.add_save_load_buttons()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">REPTATE_PROJ_JSON</span> <span class="o">=</span> <span class="s1">&#39;reptate_project.json&#39;</span> <span class="c1"># json filename inside zip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_path</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># CONSOLE WINDOW (need to integrate it with cmd commands)</span>
        <span class="c1">#self.text_edit = Console(self)</span>
        <span class="c1">#this is how you pass in locals to the interpreter</span>
        <span class="c1">#self.text_edit.initInterpreter(locals())</span>
        <span class="c1">#self.verticalLayout.addWidget(self.text_edit)</span>


<div class="viewcode-block" id="QApplicationManager.handle_show_reptate_help"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.handle_show_reptate_help">[docs]</a>    <span class="k">def</span> <span class="nf">handle_show_reptate_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show RepTate documentation&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">help_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">help_file</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;in &quot;handle_show_help&quot;:&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">QUrl</span><span class="o">.</span><span class="n">fromUserInput</span><span class="p">((</span><span class="n">help_file</span><span class="p">)))</span></div>

<div class="viewcode-block" id="QApplicationManager.handle_show_app_help"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.handle_show_app_help">[docs]</a>    <span class="k">def</span> <span class="nf">handle_show_app_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show RepTate current application (if any) manual, or all applications&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">help_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">currentWidget</span><span class="p">()</span><span class="o">.</span><span class="n">help_file</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;in &quot;handle_show_help&quot;:&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">help_file</span> <span class="o">=</span> <span class="s1">&#39;http://reptate.readthedocs.io/manual/Applications/applications.html&#39;</span>
        <span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">QUrl</span><span class="o">.</span><span class="n">fromUserInput</span><span class="p">((</span><span class="n">help_file</span><span class="p">)))</span></div>

<div class="viewcode-block" id="QApplicationManager.handle_show_th_help"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.handle_show_th_help">[docs]</a>    <span class="k">def</span> <span class="nf">handle_show_th_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show RepTate current theory (if any) manual, or all theories&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">currentWidget</span><span class="p">()</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">DataSettabWidget</span><span class="o">.</span><span class="n">currentWidget</span><span class="p">()</span>
            <span class="n">th</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">theories</span><span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">current_theory</span><span class="p">]</span>
            <span class="n">help_file</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">help_file</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;in &quot;handle_show_help&quot;:&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">help_file</span> <span class="o">=</span> <span class="s1">&#39;http://reptate.readthedocs.io/manual/All_Theories/All_Theories.html&#39;</span>
        <span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">QUrl</span><span class="o">.</span><span class="n">fromUserInput</span><span class="p">((</span><span class="n">help_file</span><span class="p">)))</span></div>

<div class="viewcode-block" id="QApplicationManager.handle_actionShow_offline_help"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.handle_actionShow_offline_help">[docs]</a>    <span class="k">def</span> <span class="nf">handle_actionShow_offline_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">QUrl</span><span class="o">.</span><span class="n">fromLocalFile</span><span class="p">(</span><span class="s1">&#39;docs/build/html/index.html&#39;</span><span class="p">))</span></div>

<div class="viewcode-block" id="QApplicationManager.handle_about_matplotlib"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.handle_about_matplotlib">[docs]</a>    <span class="k">def</span> <span class="nf">handle_about_matplotlib</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show matplotlib web site&quot;&quot;&quot;</span>
        <span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">QUrl</span><span class="o">.</span><span class="n">fromUserInput</span><span class="p">((</span><span class="s1">&#39;https://matplotlib.org/index.html&#39;</span><span class="p">)))</span></div>
        
<div class="viewcode-block" id="QApplicationManager.handle_about_numpy"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.handle_about_numpy">[docs]</a>    <span class="k">def</span> <span class="nf">handle_about_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show numpy web site&quot;&quot;&quot;</span>
        <span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">QUrl</span><span class="o">.</span><span class="n">fromUserInput</span><span class="p">((</span><span class="s1">&#39;http://www.numpy.org/&#39;</span><span class="p">)))</span></div>

<div class="viewcode-block" id="QApplicationManager.handle_about_scipy"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.handle_about_scipy">[docs]</a>    <span class="k">def</span> <span class="nf">handle_about_scipy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show scipy web site&quot;&quot;&quot;</span>
        <span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">QUrl</span><span class="o">.</span><span class="n">fromUserInput</span><span class="p">((</span><span class="s1">&#39;https://scipy.org/&#39;</span><span class="p">)))</span></div>
        
<div class="viewcode-block" id="QApplicationManager.list_theories_Maxwell"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.list_theories_Maxwell">[docs]</a>    <span class="k">def</span> <span class="nf">list_theories_Maxwell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">th_exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Redefinition for the GUI mode that lists the tab names.</span>
<span class="sd">        List the theories in the current RepTate instance that provide and need</span>
<span class="sd">        Maxwell modes</span>
<span class="sd">        </span>
<span class="sd">        [description]</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            - [type] -- [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">get_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">set_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">app</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">applications</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">app_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
            <span class="n">app_tab_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">tabText</span><span class="p">(</span><span class="n">app_index</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">ds_index</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">DataSettabWidget</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
                <span class="n">ds_tab_name</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">DataSettabWidget</span><span class="o">.</span><span class="n">tabText</span><span class="p">(</span><span class="n">ds_index</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">theories</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="n">th_index</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">TheorytabWidget</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
                    <span class="n">th_tab_name</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">TheorytabWidget</span><span class="o">.</span><span class="n">tabText</span><span class="p">(</span><span class="n">th_index</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">th</span><span class="o">.</span><span class="n">has_modes</span> <span class="ow">and</span> <span class="n">th</span> <span class="o">!=</span> <span class="n">th_exclude</span><span class="p">:</span>
                        <span class="n">get_dict</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">app_tab_name</span><span class="p">,</span> <span class="n">ds_tab_name</span><span class="p">,</span>
                                               <span class="n">th_tab_name</span><span class="p">)]</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">get_modes</span>
                        <span class="n">set_dict</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">app_tab_name</span><span class="p">,</span> <span class="n">ds_tab_name</span><span class="p">,</span>
                                               <span class="n">th_tab_name</span><span class="p">)]</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">set_modes</span>
        <span class="k">return</span> <span class="n">get_dict</span><span class="p">,</span> <span class="n">set_dict</span></div>

<div class="viewcode-block" id="QApplicationManager.handle_doubleClickTab"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.handle_doubleClickTab">[docs]</a>    <span class="k">def</span> <span class="nf">handle_doubleClickTab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Edit Application name, tab only, the dictinary key remains unchanged</span>
<span class="sd">        </span>
<span class="sd">        [description]</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">            - index {[type]} -- [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">old_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">tabText</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">QInputDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Change Application Name&quot;</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">setLabelText</span><span class="p">(</span><span class="s2">&quot;New Application Name:&quot;</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">setTextValue</span><span class="p">(</span><span class="n">old_name</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">success</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>
        <span class="n">new_tab_name</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">textValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">success</span> <span class="ow">and</span> <span class="n">new_tab_name</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">setTabText</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_tab_name</span><span class="p">)</span></div>
            <span class="c1"># self.applications[old_name].name = new_tab_name</span>
            <span class="c1"># self.applications[new_tab_name] = self.applications.pop(old_name)</span>

<div class="viewcode-block" id="QApplicationManager.show_about"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.show_about">[docs]</a>    <span class="k">def</span> <span class="nf">show_about</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show about window</span>
<span class="sd">        </span>
<span class="sd">        [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#dlg = AboutWindow(self, self.version + &#39; &#39; + self.date)</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">AboutWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&lt;br&gt;&lt;small&gt;</span><span class="se">\u00A9</span><span class="s2"> Jorge Ram√≠rez, Universidad Polit√©cnica de Madrid (2017-2020)&lt;br&gt;</span><span class="se">\u00A9</span><span class="s2"> Victor Boudara, University of Leeds (2017-2020)&lt;/small&gt;&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">VERSION</span><span class="p">,</span> <span class="n">Version</span><span class="o">.</span><span class="n">DATE</span><span class="p">))</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="QApplicationManager.tab_changed"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.tab_changed">[docs]</a>    <span class="k">def</span> <span class="nf">tab_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Capture when the active application has changed</span>
<span class="sd">        </span>
<span class="sd">        [description]</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">            - index {[type]} -- [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#appname = self.ApplicationtabWidget.widget(index).windowTitle</span>
        <span class="c1">#items = self.Projecttree.findItems(appname, Qt.MatchContains)</span>
        <span class="c1">#self.Projecttree.setCurrentItem(items[0])</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="QApplicationManager.close_app_tab"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.close_app_tab">[docs]</a>    <span class="k">def</span> <span class="nf">close_app_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">        </span>
<span class="sd">        [description]</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">            - index {[type]} -- [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">ds_name_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">datasets</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ds_name</span> <span class="ow">in</span> <span class="n">ds_name_list</span><span class="p">:</span>
            <span class="n">app</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">ds_name</span><span class="p">)</span> <span class="c1">#call theory destructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">removeTab</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="QApplicationManager.Qopen_app"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.Qopen_app">[docs]</a>    <span class="k">def</span> <span class="nf">Qopen_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">icon</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">        </span>
<span class="sd">        [description]</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">            - app_name {[type]} -- [description]</span>
<span class="sd">            - icon {[type]} -- [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newapp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">app_name</span><span class="p">)</span>
        <span class="n">newapp</span><span class="o">.</span><span class="n">createNew_Empty_Dataset</span><span class="p">(</span>
        <span class="p">)</span>  <span class="c1">#populate with empty dataset at app opening</span>
        <span class="n">app_tabname</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">app_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">application_counter</span><span class="p">)</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">newapp</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">),</span> <span class="n">app_tabname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">setTabToolTip</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">app_name</span> <span class="o">+</span> <span class="s2">&quot; app&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newapp</span></div>

<div class="viewcode-block" id="QApplicationManager.handle_new_app"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.handle_new_app">[docs]</a>    <span class="k">def</span> <span class="nf">handle_new_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open a new application window from name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qopen_app</span><span class="p">(</span><span class="n">app_name</span><span class="p">,</span>
                       <span class="s1">&#39;:/Icons/Images/new_icons/</span><span class="si">%s</span><span class="s1">.png&#39;</span> <span class="o">%</span> <span class="n">app_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="QApplicationManager.handle_app_coming_soon"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.handle_app_coming_soon">[docs]</a>    <span class="k">def</span> <span class="nf">handle_app_coming_soon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">appname</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show message&quot;&quot;&quot;</span>
        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;new </span><span class="si">%s</span><span class="s2"> application&quot;</span><span class="o">%</span> <span class="n">appname</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> coming soon...&quot;</span> <span class="o">%</span> <span class="n">appname</span><span class="p">)</span></div>



<span class="c1">############################</span>
<span class="c1">#SAVE/LOAD REPTATE SESSION</span>
<span class="c1">############################</span>


<div class="viewcode-block" id="QApplicationManager.closeEvent"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.closeEvent">[docs]</a>    <span class="k">def</span> <span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ask if we want to save project before closing RepTate (uncomment the rest)&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>
        <span class="c1"># btns = (QMessageBox.Yes | QMessageBox.No | QMessageBox.Cancel)</span>
        <span class="c1"># msg = &#39;Do you want to save your project before exiting RepTate?&#39;</span>
        <span class="c1"># title = &#39;Quit&#39;</span>
        <span class="c1"># ans = QMessageBox.question(self, title , msg, buttons=btns)</span>
        <span class="c1"># if ans == QMessageBox.No:</span>
        <span class="c1">#     event.accept()</span>
        <span class="c1"># elif ans == QMessageBox.Yes:</span>
        <span class="c1">#     success = self.launch_save_dialog()</span>
        <span class="c1">#     if not success:</span>
        <span class="c1">#         event.ignore()</span>
        <span class="c1"># elif ans == QMessageBox.Cancel:</span>
        <span class="c1">#     event.ignore()</span>

<div class="viewcode-block" id="QApplicationManager.launch_open_dialog"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.launch_open_dialog">[docs]</a>    <span class="k">def</span> <span class="nf">launch_open_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get filename of RepTate project to open&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_path</span><span class="p">:</span>
            <span class="n">fpath</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="s2">&quot;Open RepTate Project&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_path</span><span class="p">,</span> <span class="s2">&quot;RepTate Project (*.rept)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fpath</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="s2">&quot;Open RepTate Project&quot;</span><span class="p">,</span> <span class="s2">&quot;data/&quot;</span><span class="p">,</span> <span class="s2">&quot;RepTate Project (*.rept)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fpath</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open_project</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="QApplicationManager.launch_save_dialog"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.launch_save_dialog">[docs]</a>    <span class="k">def</span> <span class="nf">launch_save_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get filename of RepTate project to save&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_path</span><span class="p">:</span>
            <span class="n">fpath</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="s2">&quot;Save RepTate Project&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_path</span><span class="p">,</span> <span class="s2">&quot;RepTate Project (*.rept)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fpath</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="s2">&quot;Save RepTate Project&quot;</span><span class="p">,</span> <span class="s2">&quot;data/&quot;</span><span class="p">,</span> <span class="s2">&quot;RepTate Project (*.rept)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fpath</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_reptate</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="QApplicationManager.save_reptate"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.save_reptate">[docs]</a>    <span class="k">def</span> <span class="nf">save_reptate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save RepTate project to &#39;fpath&#39;&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_path</span> <span class="o">=</span> <span class="n">fpath</span>
        <span class="n">apps_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">napps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        <span class="n">nth_saved</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nfile_saved</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ntool_saved</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">napps</span><span class="p">):</span>
            <span class="n">app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

            <span class="c1"># Save DataSets in application</span>
            <span class="n">datasets_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">ndatasets</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">DataSettabWidget</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndatasets</span><span class="p">):</span>
                <span class="n">ds</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">DataSettabWidget</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="n">files_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
                    <span class="n">nfile_saved</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">param_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="n">pname</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">file_parameters</span><span class="p">[</span><span class="n">pname</span><span class="p">])</span> <span class="k">for</span> <span class="n">pname</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">file_parameters</span><span class="p">])</span>

                    <span class="n">file_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="p">(</span><span class="s1">&#39;fname&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">file_full_path</span><span class="p">)),</span>
                            <span class="p">(</span><span class="s1">&#39;is_active&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">active</span><span class="p">),</span>
                            <span class="p">(</span><span class="s1">&#39;fparam&#39;</span><span class="p">,</span> <span class="n">param_dic</span><span class="p">),</span>
                            <span class="p">(</span><span class="s1">&#39;ftable&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">data_table</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
                            <span class="p">(</span><span class="s1">&#39;with_extra_x&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">with_extra_x</span><span class="p">)),</span>
                            <span class="p">(</span><span class="s1">&#39;theory_xmin&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">theory_xmin</span><span class="p">),</span>
                            <span class="p">(</span><span class="s1">&#39;theory_xmax&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">theory_xmax</span><span class="p">),</span>
                            <span class="p">(</span><span class="s1">&#39;theory_logspace&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">theory_logspace</span><span class="p">)),</span>
                            <span class="p">(</span><span class="s1">&#39;th_num_pts&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">th_num_pts</span><span class="p">),</span>
                            <span class="p">(</span><span class="s1">&#39;nextramin&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">nextramin</span><span class="p">),</span>
                            <span class="p">(</span><span class="s1">&#39;nextramax&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">nextramax</span><span class="p">),</span>
                        <span class="p">]</span>
                    <span class="p">)</span>
                    <span class="n">files_dic</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">file_name_short</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_dic</span>

                <span class="c1"># Save theories in DataSet</span>
                <span class="n">theories_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
                <span class="n">ntheories</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">TheorytabWidget</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ntheories</span><span class="p">):</span>
                    <span class="n">nth_saved</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">th</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">TheorytabWidget</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                    <span class="n">param_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="n">pname</span><span class="p">,</span> <span class="n">th</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">pname</span> <span class="ow">in</span> <span class="n">th</span><span class="o">.</span><span class="n">parameters</span><span class="p">])</span>
                    <span class="n">th_table_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span> 
                        <span class="p">[</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">file_name_short</span><span class="p">,</span> <span class="n">th</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">file_name_short</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">files</span><span class="p">]</span>
                    <span class="p">)</span>
                    <span class="c1"># save extra_tables</span>
                    <span class="n">th_extra_table_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
                        <span class="n">dic_copy</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="c1"># loop over extra table and convert np.array to list</span>
                        <span class="k">for</span> <span class="n">et_key</span> <span class="ow">in</span> <span class="n">th</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">file_name_short</span><span class="p">]</span><span class="o">.</span><span class="n">extra_tables</span><span class="p">:</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">file_name_short</span><span class="p">]</span><span class="o">.</span><span class="n">extra_tables</span><span class="p">[</span><span class="n">et_key</span><span class="p">]</span>
                            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                                <span class="n">dic_copy</span><span class="p">[</span><span class="n">et_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">dic_copy</span><span class="p">[</span><span class="n">et_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
                        <span class="n">th_extra_table_dic</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">file_name_short</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic_copy</span>

                    <span class="n">th</span><span class="o">.</span><span class="n">get_extra_data</span><span class="p">()</span>
                    <span class="n">e_dic</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">extra_data</span>
                    <span class="n">e_dic_copy</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="c1"># convert numpy arrays into lists</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">e_dic</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">e_dic</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                            <span class="n">e_dic_copy</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">e_dic_copy</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

                    <span class="n">th_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="p">(</span><span class="s1">&#39;th_tabname&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">TheorytabWidget</span><span class="o">.</span><span class="n">tabText</span><span class="p">(</span><span class="n">k</span><span class="p">)),</span>
                            <span class="p">(</span><span class="s1">&#39;thname&#39;</span><span class="p">,</span> <span class="n">th</span><span class="o">.</span><span class="n">thname</span><span class="p">),</span>
                            <span class="p">(</span><span class="s1">&#39;th_param&#39;</span><span class="p">,</span> <span class="n">param_dic</span><span class="p">),</span>
                            <span class="p">(</span><span class="s1">&#39;th_textbox&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">thTextBox</span><span class="o">.</span><span class="n">toHtml</span><span class="p">())</span> <span class="o">+</span> <span class="s1">&#39;&lt;br&gt;&lt;i&gt;Saved at </span><span class="si">%s</span><span class="s1"> on </span><span class="si">%s</span><span class="s1">&lt;i&gt;&lt;br&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%X</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%a</span><span class="s2"> %b </span><span class="si">%d</span><span class="s2">, %Y&quot;</span><span class="p">)</span> <span class="p">)),</span>
                            <span class="p">(</span><span class="s1">&#39;th_tables&#39;</span><span class="p">,</span> <span class="n">th_table_dic</span><span class="p">),</span>
                            <span class="p">(</span><span class="s1">&#39;th_extra_table_dic&#39;</span><span class="p">,</span> <span class="n">th_extra_table_dic</span><span class="p">),</span>
                            <span class="p">(</span><span class="s1">&#39;extra_data&#39;</span><span class="p">,</span> <span class="n">e_dic_copy</span><span class="p">)</span>
                        <span class="p">]</span>
                    <span class="p">)</span>
                    <span class="n">theories_dic</span><span class="p">[</span><span class="n">th</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">th_dic</span>
                
                <span class="c1"># Save figure markers</span>
                <span class="n">ds_markers</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">(</span><span class="s1">&#39;marker_size&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">marker_size</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;line_width&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">line_width</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;colormode&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">colormode</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;color1&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">color1</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;color2&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">color2</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;th_line_mode&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">th_line_mode</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;th_color&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">th_color</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;palette_name&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">palette_name</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;symbolmode&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">symbolmode</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;symbol1&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">symbol1</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;symbol1_name&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">symbol1_name</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;th_linestyle&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">th_linestyle</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;th_line_width&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">th_line_width</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">)</span>
                <span class="c1"># Save full DataSet</span>
                <span class="n">ds_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">(</span><span class="s1">&#39;ds_tabname&#39;</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">DataSettabWidget</span><span class="o">.</span><span class="n">tabText</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span>
                        <span class="p">(</span><span class="s1">&#39;files&#39;</span><span class="p">,</span> <span class="n">files_dic</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;current_th_indx&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">TheorytabWidget</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()),</span>
                        <span class="p">(</span><span class="s1">&#39;theories&#39;</span><span class="p">,</span> <span class="n">theories_dic</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;ds_markers&#39;</span><span class="p">,</span> <span class="n">ds_markers</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">)</span>
                <span class="n">datasets_dic</span><span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_dict</span>

            <span class="c1"># Save Tools</span>
            <span class="n">tools_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span> <span class="c1"># contain all the tools</span>
            <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">tools</span><span class="p">:</span>
                <span class="n">ntool_saved</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">param_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">pname</span> <span class="ow">in</span> <span class="n">tool</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
                    <span class="n">param_dic</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                <span class="n">tool_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">(</span><span class="s1">&#39;tool_name&#39;</span><span class="p">,</span> <span class="n">tool</span><span class="o">.</span><span class="n">toolname</span><span class="p">),</span> <span class="c1"># what tool</span>
                        <span class="p">(</span><span class="s1">&#39;tool_tab_name&#39;</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">TooltabWidget</span><span class="o">.</span><span class="n">tabText</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">TooltabWidget</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">tool</span><span class="p">))),</span>
                        <span class="p">(</span><span class="s1">&#39;tool_to_th&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">tool</span><span class="o">.</span><span class="n">actionApplyToTheory</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())),</span>
                        <span class="p">(</span><span class="s1">&#39;tool_active&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">tool</span><span class="o">.</span><span class="n">actionActive</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())),</span>
                        <span class="p">(</span><span class="s1">&#39;tool_param&#39;</span><span class="p">,</span> <span class="n">param_dic</span><span class="p">),</span>
                        <span class="p">(</span><span class="s1">&#39;tool_txtbox&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">tool</span><span class="o">.</span><span class="n">toolTextBox</span><span class="o">.</span><span class="n">toHtml</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;&lt;br&gt;&lt;i&gt;Saved at </span><span class="si">%s</span><span class="s1"> on </span><span class="si">%s</span><span class="s1">&lt;i&gt;&lt;br&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%X</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%a</span><span class="s2"> %b </span><span class="si">%d</span><span class="s2">, %Y&quot;</span><span class="p">))))</span>
                    <span class="p">]</span>
                <span class="p">)</span> 
                <span class="c1">#add to global tools dic</span>
                <span class="n">tools_dic</span><span class="p">[</span><span class="n">tool</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tool_dic</span>
            
            <span class="c1"># all tools plus extra</span>
            <span class="n">tools</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;tools_dic&#39;</span><span class="p">:</span> <span class="n">tools_dic</span><span class="p">,</span>
                <span class="s1">&#39;cur_tab_index&#39;</span><span class="p">:</span> <span class="n">app</span><span class="o">.</span><span class="n">TooltabWidget</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
            <span class="p">}</span>
            
            <span class="c1"># annotations</span>
            <span class="n">ann_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">ann</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">graphicnotes</span><span class="p">):</span>
                <span class="n">ann_opts</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">ann_text</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
                <span class="n">ann_x</span><span class="p">,</span> <span class="n">ann_y</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
                <span class="n">ann_opts</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
                <span class="n">ann_opts</span><span class="p">[</span><span class="s2">&quot;rotation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">get_rotation</span><span class="p">()</span>
                <span class="n">ann_opts</span><span class="p">[</span><span class="s2">&quot;horizontalalignment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">get_horizontalalignment</span><span class="p">()</span>
                <span class="n">ann_opts</span><span class="p">[</span><span class="s2">&quot;verticalalignment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">get_verticalalignment</span><span class="p">()</span>
                <span class="n">ann_opts</span><span class="p">[</span><span class="s2">&quot;fontweight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">get_fontweight</span><span class="p">()</span>
                <span class="n">ann_opts</span><span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">get_fontstyle</span><span class="p">()</span>
                <span class="n">ann_opts</span><span class="p">[</span><span class="s2">&quot;fontsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">get_fontsize</span><span class="p">()</span>
                <span class="n">ann_opts</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">get_alpha</span><span class="p">()</span>
                <span class="n">ann_opts</span><span class="p">[</span><span class="s2">&quot;family&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">get_fontfamily</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ann_opts</span><span class="p">[</span><span class="s2">&quot;zorder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">()</span>
            
                <span class="n">ann_dict</span><span class="p">[</span><span class="s2">&quot;annotation_</span><span class="si">%02d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;ann_text&quot;</span><span class="p">:</span> <span class="n">ann_text</span><span class="p">,</span>
                    <span class="s2">&quot;ann_x&quot;</span><span class="p">:</span> <span class="n">ann_x</span><span class="p">,</span>
                    <span class="s2">&quot;ann_y&quot;</span><span class="p">:</span> <span class="n">ann_y</span><span class="p">,</span>
                    <span class="s2">&quot;ann_opts&quot;</span><span class="p">:</span> <span class="n">ann_opts</span>
                    <span class="p">}</span>

            <span class="c1"># collect all app info</span>
            <span class="n">app_dic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">(</span><span class="s1">&#39;app_tabname&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">tabText</span><span class="p">(</span><span class="n">i</span><span class="p">)),</span>
                    <span class="p">(</span><span class="s1">&#39;app_indx&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;appname&#39;</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">appname</span><span class="p">),</span> 
                    <span class="p">(</span><span class="s1">&#39;current_view_names&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">multiviews</span><span class="p">]),</span> 
                    <span class="p">(</span><span class="s1">&#39;current_ds_indx&#39;</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">DataSettabWidget</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()),</span>
                    <span class="p">(</span><span class="s1">&#39;datasets&#39;</span><span class="p">,</span> <span class="n">datasets_dic</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;tools&#39;</span><span class="p">,</span> <span class="n">tools</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;show_inspector&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">DataInspectordockWidget</span><span class="o">.</span><span class="n">isVisible</span><span class="p">())),</span>
                    <span class="p">(</span><span class="s1">&#39;annotations&#39;</span><span class="p">,</span> <span class="n">ann_dict</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;axis_options&#39;</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">ax_opts</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;legend_opts&#39;</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">legend_opts</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>

            <span class="n">apps_dic</span><span class="p">[</span><span class="n">app</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">app_dic</span>

        <span class="n">current_app_indx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="s1">&#39;RepTate_version&#39;</span><span class="p">,</span> <span class="n">Version</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">Version</span><span class="o">.</span><span class="n">DATE</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;project_saved_at&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> on </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%X</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%a</span><span class="s2"> %b </span><span class="si">%d</span><span class="s2">, %Y&quot;</span><span class="p">))),</span>
                <span class="p">(</span><span class="s1">&#39;napp_saved&#39;</span><span class="p">,</span> <span class="n">napps</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;nfile_saved&#39;</span><span class="p">,</span> <span class="n">nfile_saved</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;nth_saved&#39;</span><span class="p">,</span> <span class="n">nth_saved</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;ntool_saved&#39;</span><span class="p">,</span> <span class="n">ntool_saved</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;current_app_indx&#39;</span><span class="p">,</span> <span class="n">current_app_indx</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;apps&#39;</span><span class="p">,</span> <span class="n">apps_dic</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="c1"># zip output file</span>
        <span class="kn">import</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">zipfile</span><span class="o">,</span> <span class="nn">tempfile</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="n">zipfile</span><span class="o">.</span><span class="n">ZIP_DEFLATED</span><span class="p">)</span> <span class="k">as</span> <span class="n">z</span><span class="p">:</span>
                <span class="n">z</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REPTATE_PROJ_JSON</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">napps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">txtapp</span> <span class="o">=</span> <span class="s1">&#39;Applications&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">txtapp</span> <span class="o">=</span> <span class="s1">&#39;Application&#39;</span>
        <span class="k">if</span> <span class="n">nth_saved</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">txtth</span> <span class="o">=</span> <span class="s1">&#39;theories&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">txtth</span> <span class="o">=</span> <span class="s1">&#39;theory&#39;</span>
        <span class="k">if</span> <span class="n">nfile_saved</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">txtfiles</span> <span class="o">=</span> <span class="s1">&#39;files&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">txtfiles</span> <span class="o">=</span> <span class="s1">&#39;file&#39;</span>
        <span class="k">if</span> <span class="n">ntool_saved</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">txttool</span> <span class="o">=</span> <span class="s1">&#39;tools&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">txttool</span> <span class="o">=</span> <span class="s1">&#39;tool&#39;</span>
        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Save RepTate Project&#39;</span><span class="p">,</span> <span class="s1">&#39;Saved </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1">, </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1">, </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1">, and </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> to </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">napps</span><span class="p">,</span> <span class="n">txtapp</span><span class="p">,</span> <span class="n">nth_saved</span><span class="p">,</span> <span class="n">txtth</span><span class="p">,</span> <span class="n">nfile_saved</span><span class="p">,</span> <span class="n">txtfiles</span><span class="p">,</span> <span class="n">ntool_saved</span><span class="p">,</span> <span class="n">txttool</span><span class="p">,</span> <span class="n">fpath</span><span class="p">))</span></div>

    <span class="c1"># load RepTate session</span>
<span class="c1">############################</span>

<div class="viewcode-block" id="QApplicationManager.restore_app"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.restore_app">[docs]</a>    <span class="k">def</span> <span class="nf">restore_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">app_tabname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open new application&quot;&quot;&quot;</span>
        <span class="n">newapp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">app_name</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;:/Icons/Images/new_icons/</span><span class="si">%s</span><span class="s1">.png&#39;</span> <span class="o">%</span> <span class="n">app_name</span><span class="p">)</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">newapp</span><span class="p">,</span> <span class="n">icon</span><span class="p">,</span> <span class="n">app_tabname</span><span class="p">)</span>
        <span class="c1"># self.ApplicationtabWidget.setCurrentIndex(ind)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">setTabToolTip</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">app_name</span> <span class="o">+</span> <span class="s2">&quot; app&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">ind</span><span class="p">),</span> <span class="n">ind</span></div>

<div class="viewcode-block" id="QApplicationManager.restore_files"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.restore_files">[docs]</a>    <span class="k">def</span> <span class="nf">restore_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">files</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open data files&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">file_dic</span> <span class="ow">in</span> <span class="n">files</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="n">file_dic</span><span class="p">[</span><span class="s1">&#39;fname&#39;</span><span class="p">]</span>
            <span class="n">is_active</span> <span class="o">=</span> <span class="n">file_dic</span><span class="p">[</span><span class="s1">&#39;is_active&#39;</span><span class="p">]</span>
            <span class="n">fparams</span> <span class="o">=</span> <span class="n">file_dic</span><span class="p">[</span><span class="s1">&#39;fparam&#39;</span><span class="p">]</span> <span class="c1"># dict</span>
            <span class="n">ftable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">file_dic</span><span class="p">[</span><span class="s1">&#39;ftable&#39;</span><span class="p">])</span>

            
            <span class="n">f_ext</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ft</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">parent_application</span><span class="o">.</span><span class="n">filetypes</span><span class="p">[</span><span class="n">f_ext</span><span class="p">]</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">File</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">ft</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">parent_application</span><span class="o">.</span><span class="n">axarr</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">data_table</span><span class="o">.</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">data_table</span><span class="o">.</span><span class="n">num_columns</span> <span class="o">=</span> <span class="n">ftable</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">f</span><span class="o">.</span><span class="n">data_table</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">ftable</span>

            <span class="n">ds</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">current_file</span> <span class="o">=</span> <span class="n">f</span>
            <span class="n">f</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="n">is_active</span>
            <span class="k">for</span> <span class="n">pname</span> <span class="ow">in</span> <span class="n">fparams</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">file_parameters</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span> <span class="o">=</span> <span class="n">fparams</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">with_extra_x</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">file_dic</span><span class="p">[</span><span class="s1">&#39;with_extra_x&#39;</span><span class="p">])</span>
                <span class="n">f</span><span class="o">.</span><span class="n">theory_xmin</span> <span class="o">=</span> <span class="n">file_dic</span><span class="p">[</span><span class="s1">&#39;theory_xmin&#39;</span><span class="p">]</span>
                <span class="n">f</span><span class="o">.</span><span class="n">theory_xmax</span> <span class="o">=</span> <span class="n">file_dic</span><span class="p">[</span><span class="s1">&#39;theory_xmax&#39;</span><span class="p">]</span>
                <span class="n">f</span><span class="o">.</span><span class="n">theory_logspace</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">file_dic</span><span class="p">[</span><span class="s1">&#39;theory_logspace&#39;</span><span class="p">])</span>
                <span class="n">f</span><span class="o">.</span><span class="n">th_num_pts</span> <span class="o">=</span> <span class="n">file_dic</span><span class="p">[</span><span class="s1">&#39;th_num_pts&#39;</span><span class="p">]</span>
                <span class="n">f</span><span class="o">.</span><span class="n">nextramin</span> <span class="o">=</span> <span class="n">file_dic</span><span class="p">[</span><span class="s1">&#39;nextramin&#39;</span><span class="p">]</span>
                <span class="n">f</span><span class="o">.</span><span class="n">nextramax</span> <span class="o">=</span> <span class="n">file_dic</span><span class="p">[</span><span class="s1">&#39;nextramax&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span> <span class="c1"># backward compatibility</span>

            <span class="n">ds</span><span class="o">.</span><span class="n">parent_application</span><span class="o">.</span><span class="n">addTableToCurrentDataSet</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_ext</span><span class="p">)</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">do_plot</span><span class="p">()</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">parent_application</span><span class="o">.</span><span class="n">update_Qplot</span><span class="p">()</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">set_table_icons</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">table_icon_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="QApplicationManager.restore_theories"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.restore_theories">[docs]</a>    <span class="k">def</span> <span class="nf">restore_theories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">theories</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open theories&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">th_dic</span> <span class="ow">in</span> <span class="n">theories</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">th_tabname</span> <span class="o">=</span> <span class="n">th_dic</span><span class="p">[</span><span class="s1">&#39;th_tabname&#39;</span><span class="p">]</span>
            <span class="n">thname</span> <span class="o">=</span> <span class="n">th_dic</span><span class="p">[</span><span class="s1">&#39;thname&#39;</span><span class="p">]</span>
            <span class="n">th_param</span> <span class="o">=</span> <span class="n">th_dic</span><span class="p">[</span><span class="s1">&#39;th_param&#39;</span><span class="p">]</span>
            <span class="n">th_textbox</span> <span class="o">=</span> <span class="n">th_dic</span><span class="p">[</span><span class="s1">&#39;th_textbox&#39;</span><span class="p">]</span>
            <span class="n">th_tables</span> <span class="o">=</span> <span class="n">th_dic</span><span class="p">[</span><span class="s1">&#39;th_tables&#39;</span><span class="p">]</span>
            <span class="n">extra_data</span> <span class="o">=</span> <span class="n">th_dic</span><span class="p">[</span><span class="s1">&#39;extra_data&#39;</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">extra_table_dic</span> <span class="o">=</span> <span class="n">th_dic</span><span class="p">[</span><span class="s1">&#39;th_extra_table_dic&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="c1"># backward compatibility</span>
                <span class="n">extra_table_dic</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">extra_data</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">extra_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="n">extra_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">thname</span> <span class="o">==</span> <span class="s1">&#39;SCCR&#39;</span><span class="p">:</span>
                <span class="n">thname</span> <span class="o">=</span> <span class="s1">&#39;GLaMM&#39;</span> <span class="c1"># backward compatibility</span>
            <span class="n">new_th</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">new_theory</span><span class="p">(</span><span class="n">thname</span><span class="p">,</span> <span class="n">th_tabname</span><span class="p">,</span> <span class="n">calculate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">autocal</span> <span class="o">=</span> <span class="n">new_th</span><span class="o">.</span><span class="n">autocalculate</span>
            <span class="n">new_th</span><span class="o">.</span><span class="n">autocalculate</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">pname</span> <span class="ow">in</span> <span class="n">th_param</span><span class="p">:</span>
                <span class="n">new_th</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="n">pname</span><span class="p">,</span> <span class="n">th_param</span><span class="p">[</span><span class="n">pname</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">th_tables</span><span class="p">:</span>
                <span class="n">tt</span> <span class="o">=</span> <span class="n">new_th</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">fname</span><span class="p">]</span>
                <span class="n">tt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">th_tables</span><span class="p">[</span><span class="n">fname</span><span class="p">])</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">num_columns</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">tt</span><span class="o">.</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">num_columns</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">extra_table_dic</span><span class="p">:</span>
                <span class="n">tt_dic</span> <span class="o">=</span> <span class="n">new_th</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">fname</span><span class="p">]</span><span class="o">.</span><span class="n">extra_tables</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">extra_table_dic</span><span class="p">[</span><span class="n">fname</span><span class="p">]:</span>
                    <span class="n">tt_dic</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">extra_table_dic</span><span class="p">[</span><span class="n">fname</span><span class="p">][</span><span class="n">key</span><span class="p">])</span>
            <span class="n">new_th</span><span class="o">.</span><span class="n">set_extra_data</span><span class="p">(</span><span class="n">extra_data</span><span class="p">)</span>
            <span class="n">new_th</span><span class="o">.</span><span class="n">update_parameter_table</span><span class="p">()</span>
            <span class="n">new_th</span><span class="o">.</span><span class="n">thTextBox</span><span class="o">.</span><span class="n">insertHtml</span><span class="p">(</span><span class="n">th_textbox</span><span class="p">)</span>
            <span class="n">new_th</span><span class="o">.</span><span class="n">autocalculate</span> <span class="o">=</span> <span class="n">autocal</span></div>
    
<div class="viewcode-block" id="QApplicationManager.restore_marker_settings"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.restore_marker_settings">[docs]</a>    <span class="k">def</span> <span class="nf">restore_marker_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">marker_dic</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restore the dataset marker settings&quot;&quot;&quot;</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">marker_size</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;marker_size&#39;</span><span class="p">]</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;line_width&#39;</span><span class="p">]</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">colormode</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;colormode&#39;</span><span class="p">]</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">color1</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;color1&#39;</span><span class="p">]</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">color2</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;color2&#39;</span><span class="p">]</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">th_line_mode</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;th_line_mode&#39;</span><span class="p">]</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">th_color</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;th_color&#39;</span><span class="p">]</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">palette_name</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;palette_name&#39;</span><span class="p">]</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">symbolmode</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;symbolmode&#39;</span><span class="p">]</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">symbol1</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;symbol1&#39;</span><span class="p">]</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">symbol1_name</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;symbol1_name&#39;</span><span class="p">]</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">th_linestyle</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;th_linestyle&#39;</span><span class="p">]</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">th_line_width</span> <span class="o">=</span> <span class="n">marker_dic</span><span class="p">[</span><span class="s1">&#39;th_line_width&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="QApplicationManager.restore_tools"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.restore_tools">[docs]</a>    <span class="k">def</span> <span class="nf">restore_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">tools</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restore the tools&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">tdic</span> <span class="ow">in</span> <span class="n">tools</span><span class="p">[</span><span class="s1">&#39;tools_dic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">toolname</span> <span class="o">=</span> <span class="n">tdic</span><span class="p">[</span><span class="s1">&#39;tool_name&#39;</span><span class="p">]</span>
            <span class="n">tool_tab_name</span> <span class="o">=</span> <span class="n">tdic</span><span class="p">[</span><span class="s1">&#39;tool_tab_name&#39;</span><span class="p">]</span>
            <span class="n">tool_to_th</span> <span class="o">=</span> <span class="n">tdic</span><span class="p">[</span><span class="s1">&#39;tool_to_th&#39;</span><span class="p">]</span>
            <span class="n">tool_active</span> <span class="o">=</span> <span class="n">tdic</span><span class="p">[</span><span class="s1">&#39;tool_active&#39;</span><span class="p">]</span>
            <span class="n">tool_param</span> <span class="o">=</span> <span class="n">tdic</span><span class="p">[</span><span class="s1">&#39;tool_param&#39;</span><span class="p">]</span>
            <span class="n">tool_txtbox</span> <span class="o">=</span> <span class="n">tdic</span><span class="p">[</span><span class="s1">&#39;tool_txtbox&#39;</span><span class="p">]</span>

            <span class="c1"># create new tool and set state</span>
            <span class="n">to</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">new_tool</span><span class="p">(</span><span class="n">toolname</span><span class="p">,</span> <span class="n">tool_tab_name</span><span class="p">)</span>
            <span class="n">to</span><span class="o">.</span><span class="n">handle_actionApplyToTheorypressed</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">tool_to_th</span><span class="p">))</span>
            <span class="n">to</span><span class="o">.</span><span class="n">handle_actionActivepressed</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">tool_active</span><span class="p">))</span>
            <span class="n">to</span><span class="o">.</span><span class="n">toolTextBox</span><span class="o">.</span><span class="n">insertHtml</span><span class="p">(</span><span class="n">tool_txtbox</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pname</span> <span class="ow">in</span> <span class="n">tool_param</span><span class="p">:</span>
                <span class="n">to</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="n">pname</span><span class="p">,</span> <span class="n">tool_param</span><span class="p">[</span><span class="n">pname</span><span class="p">])</span>
        <span class="n">app</span><span class="o">.</span><span class="n">TooltabWidget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">tools</span><span class="p">[</span><span class="s1">&#39;cur_tab_index&#39;</span><span class="p">])</span></div>
    
<div class="viewcode-block" id="QApplicationManager.restore_annotations"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.restore_annotations">[docs]</a>    <span class="k">def</span> <span class="nf">restore_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">annotations</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restore the annotations&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">ann</span> <span class="ow">in</span> <span class="n">annotations</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">ann_text</span> <span class="o">=</span> <span class="n">ann</span><span class="p">[</span><span class="s2">&quot;ann_text&quot;</span><span class="p">]</span>
            <span class="n">ann_x</span> <span class="o">=</span> <span class="n">ann</span><span class="p">[</span><span class="s2">&quot;ann_x&quot;</span><span class="p">]</span>
            <span class="n">ann_y</span> <span class="o">=</span> <span class="n">ann</span><span class="p">[</span><span class="s2">&quot;ann_y&quot;</span><span class="p">]</span>
            <span class="n">ann_opts</span> <span class="o">=</span> <span class="n">ann</span><span class="p">[</span><span class="s2">&quot;ann_opts&quot;</span><span class="p">]</span>
            <span class="n">app</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">ann_text</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">ann_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ann_y</span><span class="p">,</span> <span class="n">annotation_opts</span><span class="o">=</span><span class="n">ann_opts</span><span class="p">)</span></div>

<div class="viewcode-block" id="QApplicationManager.open_project"><a class="viewcode-back" href="../developers/CodeCoreGUI.html#QApplicationManager.QApplicationManager.open_project">[docs]</a>    <span class="k">def</span> <span class="nf">open_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open file and load project&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">zipfile</span><span class="o">,</span> <span class="nn">tempfile</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">project_path</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_path</span> <span class="o">=</span> <span class="n">project_path</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">project_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">z</span><span class="p">:</span>
                    <span class="n">z</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">REPTATE_PROJ_JSON</span><span class="p">,</span> <span class="n">tmpdirname</span><span class="p">)</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">REPTATE_PROJ_JSON</span><span class="p">)),</span> <span class="n">object_pairs_hook</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;File </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> seems to be corrupted&quot;</span> <span class="o">%</span> <span class="n">project_path</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">app_indx_now</span> <span class="o">=</span> <span class="n">current_app_indx</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;current_app_indx&#39;</span><span class="p">]</span>
            <span class="n">apps_dic</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;apps&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not find data in </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">project_path</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">calc_mode_tmp</span> <span class="o">=</span> <span class="n">CmdBase</span><span class="o">.</span><span class="n">calcmode</span>
        <span class="n">CmdBase</span><span class="o">.</span><span class="n">calcmode</span> <span class="o">=</span> <span class="n">CalcMode</span><span class="o">.</span><span class="n">singlethread</span>
        <span class="n">napps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;napp_saved&#39;</span><span class="p">])</span>
        <span class="n">nth_saved</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;nth_saved&#39;</span><span class="p">])</span>
        <span class="n">nfile_saved</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;nfile_saved&#39;</span><span class="p">])</span>
        <span class="n">ntool_saved</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ntool_saved&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">napps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">txtapp</span> <span class="o">=</span> <span class="s1">&#39;Applications&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">txtapp</span> <span class="o">=</span> <span class="s1">&#39;Application&#39;</span>
        <span class="k">if</span> <span class="n">nth_saved</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">txtth</span> <span class="o">=</span> <span class="s1">&#39;theories&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">txtth</span> <span class="o">=</span> <span class="s1">&#39;theory&#39;</span>
        <span class="k">if</span> <span class="n">nfile_saved</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">txtfiles</span> <span class="o">=</span> <span class="s1">&#39;files&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">txtfiles</span> <span class="o">=</span> <span class="s1">&#39;file&#39;</span>
        <span class="k">if</span> <span class="n">ntool_saved</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">txttool</span> <span class="o">=</span> <span class="s1">&#39;tools&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">txttool</span> <span class="o">=</span> <span class="s1">&#39;tool&#39;</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Load Project&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;Will load </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1">, </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1">, </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1">, and </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="s1">.</span><span class="se">\n</span><span class="s1">Do you want to continue?&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">napps</span><span class="p">,</span> 
            <span class="n">txtapp</span><span class="p">,</span> <span class="n">nth_saved</span><span class="p">,</span> <span class="n">txtth</span><span class="p">,</span> <span class="n">nfile_saved</span><span class="p">,</span> <span class="n">txtfiles</span><span class="p">,</span> <span class="n">ntool_saved</span><span class="p">,</span> <span class="n">txttool</span><span class="p">),</span> 
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="o">|</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ans</span> <span class="o">!=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">app_dic</span> <span class="ow">in</span> <span class="n">apps_dic</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">app_tabname</span> <span class="o">=</span> <span class="n">app_dic</span><span class="p">[</span><span class="s1">&#39;app_tabname&#39;</span><span class="p">]</span>
            <span class="n">app_indx</span> <span class="o">=</span> <span class="n">app_dic</span><span class="p">[</span><span class="s1">&#39;app_indx&#39;</span><span class="p">]</span> 
            <span class="n">appname</span> <span class="o">=</span> <span class="n">app_dic</span><span class="p">[</span><span class="s1">&#39;appname&#39;</span><span class="p">]</span>
            <span class="n">current_view_names</span> <span class="o">=</span> <span class="n">app_dic</span><span class="p">[</span><span class="s1">&#39;current_view_names&#39;</span><span class="p">]</span>
            <span class="n">current_ds_indx</span> <span class="o">=</span> <span class="n">app_dic</span><span class="p">[</span><span class="s1">&#39;current_ds_indx&#39;</span><span class="p">]</span>
            <span class="n">datasets</span> <span class="o">=</span> <span class="n">app_dic</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">]</span>
            <span class="n">tools</span> <span class="o">=</span> <span class="n">app_dic</span><span class="p">[</span><span class="s1">&#39;tools&#39;</span><span class="p">]</span>
            <span class="n">show_inspector</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">app_dic</span><span class="p">[</span><span class="s1">&#39;show_inspector&#39;</span><span class="p">])</span>
            <span class="n">annotations</span> <span class="o">=</span> <span class="n">app_dic</span><span class="p">[</span><span class="s1">&#39;annotations&#39;</span><span class="p">]</span>

            <span class="n">new_app_tab</span><span class="p">,</span> <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">restore_app</span><span class="p">(</span><span class="n">appname</span><span class="p">,</span> <span class="n">app_tabname</span><span class="p">)</span>
   
            <span class="k">try</span><span class="p">:</span>
                <span class="n">new_app_tab</span><span class="o">.</span><span class="n">ax_opts</span> <span class="o">=</span> <span class="n">app_dic</span><span class="p">[</span><span class="s1">&#39;axis_options&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="c1">#backward compatibility</span>
                <span class="k">pass</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">new_app_tab</span><span class="o">.</span><span class="n">legend_opts</span> <span class="o">=</span> <span class="n">app_dic</span><span class="p">[</span><span class="s1">&#39;legend_opts&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="c1">#backward compatibility</span>
                <span class="k">pass</span>

            <span class="k">if</span> <span class="n">app_indx</span> <span class="o">==</span> <span class="n">current_app_indx</span><span class="p">:</span>
                <span class="c1"># to be safe in case some apps are open before restore</span>
                <span class="n">app_indx_now</span> <span class="o">=</span> <span class="n">ind</span>

            <span class="k">for</span> <span class="n">ds_dic</span> <span class="ow">in</span> <span class="n">datasets</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">ds_tabname</span> <span class="o">=</span> <span class="n">ds_dic</span><span class="p">[</span><span class="s1">&#39;ds_tabname&#39;</span><span class="p">]</span>
                <span class="n">files</span> <span class="o">=</span> <span class="n">ds_dic</span><span class="p">[</span><span class="s1">&#39;files&#39;</span><span class="p">]</span>
                <span class="n">current_th_indx</span> <span class="o">=</span> <span class="n">ds_dic</span><span class="p">[</span><span class="s1">&#39;current_th_indx&#39;</span><span class="p">]</span>
                <span class="n">theories</span> <span class="o">=</span> <span class="n">ds_dic</span><span class="p">[</span><span class="s1">&#39;theories&#39;</span><span class="p">]</span>
                <span class="n">ds_markers</span> <span class="o">=</span> <span class="n">ds_dic</span><span class="p">[</span><span class="s1">&#39;ds_markers&#39;</span><span class="p">]</span>

                <span class="n">new_ds_tab</span> <span class="o">=</span> <span class="n">new_app_tab</span><span class="o">.</span><span class="n">createNew_Empty_Dataset</span><span class="p">(</span><span class="n">tabname</span><span class="o">=</span><span class="n">ds_tabname</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">restore_files</span><span class="p">(</span><span class="n">new_ds_tab</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">restore_theories</span><span class="p">(</span><span class="n">new_ds_tab</span><span class="p">,</span> <span class="n">theories</span><span class="p">)</span>
                <span class="n">new_ds_tab</span><span class="o">.</span><span class="n">TheorytabWidget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">current_th_indx</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">restore_marker_settings</span><span class="p">(</span><span class="n">new_ds_tab</span><span class="p">,</span> <span class="n">ds_markers</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">restore_tools</span><span class="p">(</span><span class="n">new_app_tab</span><span class="p">,</span> <span class="n">tools</span><span class="p">)</span>
            <span class="n">new_app_tab</span><span class="o">.</span><span class="n">DataInspectordockWidget</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">show_inspector</span><span class="p">)</span>
            
            <span class="c1"># restore annotations</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">restore_annotations</span><span class="p">(</span><span class="n">new_app_tab</span><span class="p">,</span> <span class="n">annotations</span><span class="p">)</span>
            
            <span class="c1"># set app views</span>
            <span class="n">new_app_tab</span><span class="o">.</span><span class="n">multiviews</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_app_tab</span><span class="o">.</span><span class="n">views</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">current_view_names</span><span class="p">]</span>
            <span class="n">new_app_tab</span><span class="o">.</span><span class="n">viewComboBox</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">current_view_names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">new_app_tab</span><span class="o">.</span><span class="n">change_view</span><span class="p">()</span>
            <span class="c1">#set current ds_tab index</span>
            <span class="n">new_app_tab</span><span class="o">.</span><span class="n">DataSettabWidget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">current_ds_indx</span><span class="p">)</span>
            <span class="c1"># new_app_tab.update_all_ds_plots() # not needed ?</span>
            
            <span class="n">QApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ApplicationtabWidget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">app_indx_now</span><span class="p">)</span>
        <span class="n">CmdBase</span><span class="o">.</span><span class="n">calcmode</span> <span class="o">=</span> <span class="n">calc_mode_tmp</span></div></div>
<span class="c1">#################</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">RepTate 0.9.7 20200117 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Universidad Polit√©cnica de Madrid, University of Leeds.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1.
    </div>
  </body>
</html>